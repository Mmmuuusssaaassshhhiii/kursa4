@model IEnumerable<kursa4.Models.Laptop>

@{
    ViewData["Title"] = "Ноутбуки";
}

<h2 class="mb-4">Список ноутбуков</h2>

<button type="button" class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#addLaptopModal">
    Добавить ноутбук
</button>

<div class="table-responsive">
    <table class="table table-bordered table-striped align-middle table-sm">
        <thead class="table-dark">
        <tr>
            <th>ID</th>
            <th>Название</th>
            <th>Категория</th>
            <th>CPU / GPU</th>
            <th>ОЗУ / Память</th>
            <th>Экран</th>
            <th>Частота / Батарея</th>
            <th>Размер / Вес</th>
            <th>Клав. / Камера</th>
            <th>OS</th>
            <th>Цена</th>
            <th>В наличии</th>
            <th>Год</th>
            <th></th>
        </tr>
        </thead>
        <tbody>
        @foreach (var laptop in Model)
        {
            <tr>
                <td>@laptop.Id</td>
                <td>@($"{laptop.Brand?.Name} {laptop.Model}")</td>
                <td>@laptop.Category?.Name</td>
                <td>
                    @laptop.CPU?.Name<br />
                    @laptop.GPU?.Name
                </td>
                <td>@($"{laptop.RAM?.SizeGb} ГБ / {laptop.Storage?.SizeGb} ГБ")</td>
                <td>@($"{laptop.ScreenSize}\" / {laptop.Resolution}")</td>
                <td>@($"{laptop.RefreshRate} Гц / {laptop.BatteryWh} Втч")</td>
                <td>@($"{laptop.Width}×{laptop.Height}×{laptop.Depth} см / {laptop.Weight} кг")</td>
                <td>
                    @(laptop.KeyboardBackLight ? "Подсветка" : "-") /
                    @(laptop.HasWebcam ? "Камера" : "-")
                </td>
                <td>@laptop.OS</td>
                <td>@($"{laptop.Price:C}")</td>
                <td>@laptop.StockQuantity</td>
                <td>@laptop.ReleaseYear</td>
                <td>
                    <a asp-action="Edit" asp-route-id="@laptop.Id" class="btn btn-sm btn-warning">Изменить</a>
                    <a asp-action="Delete" asp-route-id="@laptop.Id" class="btn btn-sm btn-danger">Удалить</a>
                </td>
            </tr>
        }
        </tbody>
    </table>

    <!-- Модальное окно добавления -->
    <div class="modal fade" id="addLaptopModal" tabindex="-1" aria-labelledby="addLaptopModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <form asp-action="AddLaptop" asp-controller="Admin" method="post">
                    <div class="modal-header">
                        <h5 class="modal-title" id="addLaptopModalLabel">Добавить ноутбук</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Закрыть"></button>
                    </div>
                    <div class="modal-body" style="max-height: calc(100vh - 200px); overflow-y: auto;">
                        @Html.AntiForgeryToken()

                        <div class="mb-3">
                            <label class="form-label">Модель</label>
                            <input type="text" name="Model" class="form-control" required />
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Категория</label>
                            <select name="CategoryId" class="form-select" required>
                                <option value="">Выберите категорию</option>
                                @foreach (var category in ViewBag.Categories)
                                {
                                    <option value="@category.Id">@category.Name</option>
                                }
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Бренд</label>
                            <select name="BrandId" class="form-select" required>
                                <option value="">Выберите бренд</option>
                                @foreach (var brand in ViewBag.Brands)
                                {
                                    <option value="@brand.Id">@brand.Name</option>
                                }
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">ЦПУ</label>
                            <select name="CPUId" class="form-select" required>
                                <option value="">Выберите ЦПУ</option>
                                @foreach (var cpu in ViewBag.CPUs)
                                {
                                    <option value="@cpu.Id">@cpu.Name</option>
                                }
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">ГПУ</label>
                            <select name="GPUId" class="form-select" required>
                                <option value="">Выберите ГПУ</option>
                                @foreach (var gpu in ViewBag.GPUs)
                                {
                                    <option value="@gpu.Id">@gpu.Name</option>
                                }
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">ОЗУ</label>
                            <select name="RAMId" class="form-select" required>
                                <option value="">Выберите ОЗУ</option>
                                @foreach (var ram in ViewBag.RAMs)
                                {
                                    <option value="@ram.Id">@($"{ram.Type} - {ram.SizeGb} ГБ")</option>
                                }
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Память</label>
                            <select name="StorageId" class="form-select" required>
                                <option value="">Выберите память</option>
                                @foreach (var storage in ViewBag.Storages)
                                {
                                    <option value="@storage.Id">@($"{storage.Type} - {storage.SizeGb} ГБ")</option>
                                }
                            </select>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Операционная система</label>
                            <input type="text" name="OS" class="form-control" required />
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Цена</label>
                            <input type="number" name="Price" step="0.01" class="form-control" required />
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Год выпуска</label>
                            <input type="number" name="ReleaseYear" class="form-control" required />
                        </div>

                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" name="KeyboardBackLight" />
                            <label class="form-check-label">Подсветка клавиатуры</label>
                        </div>

                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" name="HasWebcam" />
                            <label class="form-check-label">Есть вебкамера</label>
                        </div>

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                        <button type="submit" class="btn btn-success">Добавить</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
